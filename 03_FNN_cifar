import numpy as np
import tensorflow as tf
import matplotlib.pyplot as plt
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Flatten,Dense
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.datasets import cifar10

(x_train,y_train),(x_test,y_test)=cifar10.load_data()

x_train=x_train.astype('float32')/255
x_test=x_test.astype('float32')/255

y_train=to_categorical(y_train,10)
y_test=to_categorical(y_test,10)

class_names=['Airplane','Dog','Cat','Frog','Automobile',
             'Deer','Horse','Ship','Truck','Bird']

model=Sequential([
    Flatten(input_shape=(32,32,3)),
    Dense(512,activation='relu'),
    Dense(256,activation='relu'),
    Dense(128,activation='relu'),
    Dense(10,activation='softmax'),
])  

model.compile(optimizer='adam',
              loss='categorical_crossentropy',
              metrics=['accuracy'],
)

history=model.fit(x_train,y_train,epochs=10,batch_size=128,validation_split=0.1,verbose=1)

predictions = model.predict(x_test)

import random
i = random.randint(0, len(x_test)-1)

plt.imshow(x_test[i], cmap='gray')
plt.title("Predicted: " + class_names[predictions[i].argmax()])
plt.axis('off')
plt.show()

plt.plot(history.history['accuracy'],label='Train_accuracy')
plt.plot(history.history['val_accuracy'],label='val_accuracy')
plt.title('accuracy')
plt.xlabel('epochs')
plt.ylabel('accuracy')
plt.legend()

plt.plot(history.history['loss'],label='Train_accuracy')
plt.plot(history.history['val_loss'],label='val_accuracy')
plt.title('accuracy')
plt.xlabel('epochs')
plt.ylabel('accuracy')
plt.legend()
